### Security Audit Terminology

A **Security Audit** is an independent review and examination of a system's records and activities to determine the adequacy of system controls, ensure compliance with established security policy and procedures, detect breached in security services , and recommend any changed that are indicated for countermeasures. The basic audit is to establish accountability for system entries that initiate or participate in security-relevant events and actions. Thus, means are needed to generate and record a security audit trail and to review and analyse the audit trail to discover and investigate attacks and security compromises.

A **Security Audit Trail** is a chronological record of system activities that is sufficient to enable the reconstruction and examination of the sequence of environments and activities surrounding or leading to an operation, procedure, or event in a security-relevant transaction for inception to final results.

![[Pasted image 20260101224934.png]]

![[Pasted image 20260101224949.png]]

![[Pasted image 20260101225000.png]]

### Event Definition

You must define the set of events that are subject to audit.

Common criteria suggest:

 - Introduction of objects.
 - Deletion of objects.
 - Distribution or revocation of access rights or capabilities.
 - Changes to subject or object security attributes.
 - Policy checks performed by the security software.
 - Use of access rights to bypass a policy check.
 - Use of identification and authentication functions.
 - Security-related actions taken by an operator / user.
 - Import / export of data from / to removable media.

### Event Detection

- Appropriate hooks must be available in the application and system software to enable event detection.
 - Monitoring software needs to be added to the system and to appropriate places to capture relevant activity.
 - An event recording function is needed, which includes the need to provide for a secure storage resistant to tampering or deletion.
 - Event and audit trail analysis software, tools, and interfaces may be used to analyse collected data as well as for investigating data trends and anomalies.
 - There is an additional requirement for the security of the auditing function.
 - Auditing system should have a minimal effect on the functionality.

### Implementation Guidelines

![[Pasted image 20260101225506.png]]

### What to collect

 - Events related to the use of auditing software.
 - Events related to the security mechanisms on the system.
 - Events that are collected for use by the various security detection and prevention mechanisms.
 - Event related to system management and operation.
 - Operating system access.
 - Application access for selected applications.
 - Remote access.

![[Pasted image 20260101225625.png]]

### Monitoring table as suggested in ISO 27002

![[Pasted image 20260101225648.png]]

![[Pasted image 20260101225702.png]]

### Physical Access Audit Trails

 - Generated by equipment that controls physical access.
	 - Card-key systems, alarm systems.
 - Sent to central host for analysis and storage.
 - Data of interest:
	 - Data / time / location / user of access attempt.
	 - Both valid and invalid access attempts.
	 - Attempts to add / modify / delete physical access privileges.
	 - May send violation messages.


### Protecting Audit Trail Data

 - Read / Write file on host
	 - East, least resource intensive, instant access.
- Write-once / read-many device
	- More secure but less convenient.
- Write-only device
	- Provides paper trail.
	- Impractical for capturing detailed audit data on large or networked systems.
	- Useful when a permanent, immediately available log is required.
- Must protect both integrity and confidentiality
	- Encryption, digital signatures, access controls.

### Implementing Logging

 - Foundation of security auditing facility is the initial capture of the audit data.
 - Software must include hooks (capture points) that trigger data collection and storage as preselected events occur.
 - Dependent on the nature of the software.
	 - Varies depending on operating system and applications involved.

### Windows Event Log

 - Event is an entity that describes some interesting occurrence.
	 - Contains;
		 - A numeric identification code.
		 - A set of attributes.
		 - Optional user-supplied data.
 - Three types of event logs:
	 - System: system related apps and drivers.
	 - Application: user-level apps.
	 - Security: Windows LSA.

![[Pasted image 20260101230716.png]]

![[Pasted image 20260101230728.png]]

### Windows Event Categories

![[Pasted image 20260101230747.png]]

### UNIX syslog

 - UNIX's general-purpose logging mechanism.
 - Found on all UNIX / Linux variants.

 - Elements:
	 - `syslog0`
		 - API referenced by several standard system utilities and available to application programs.
	 - `logger`
		 - Command used to add single-line entries to the system log.
	 - `/etc/syslog.conf`
		 - Configuration file used to control the logging and routing of system log events.
	 - `syslogd`
		 - Daemon to receive / route log events.

### `syslog` Service

![[Pasted image 20260101231010.png]]

### `syslog` Protocol

 - A transport allowing hsts to send IP event notification messages to `syslog` servers.
	 - Provides a very general message format.
	 - Allowing processes and applications to use suitable conventions for their logged events.
	 - Common version of the `syslog` protocol was originally developed on the University of California Berkeley Software Distribution (BSD) UNIX / TCP / IP system implementations.
	 - Messages in the BSD `syslog` format consist of:
		 - PRI - facilities / severity code.
		 - Header - timestamp and hostname / IP address.
		 - MSG - program name and content.

![[Pasted image 20260101231355.png]]

![[Pasted image 20260101231406.png]]

### Logging at Application Level

 - Privileged applications present security issues:
	 - May not be captured by system / user-level audit data.
	 - Constitute a large percentage of reported vulnerabilities.
 - Vulnerabilities exploited:
	 - Lack of dynamic checks of input data.
	 - Errors in application logic.
 - May be necessary to capture behaviour of application beyond its access to system services and file systems.
 - Two approached to collection audit data:
	 - Interposable libraries.
	 - Dynamic binary rewriting.

### Audit Trail Analysis

-  Analysis programs and procedures vary widely.
- Must understand context of log entries.
	- Relevant information may reside in other entries in the same logs, other logs, and nonlog sources.
- Audit file formats contain mix of plain text and codes.
	- Must decipher manually / automatically.
- Ideally regularly review entries to gain understanding of baseline.

### Types of Audit Trail Analysis

Audit trails can be used in multiple ways, this depends in part on when done.

Possibilities include:

 - Audit trail review after an event.
	 - Triggered by event to diagnose cause and remediate.
	 - Focuses on the audit trail entries that are relevant to the specific event.
 - Periodic review of audit trail data
	 - Review bulk data to identify problems and behaviour.
 - Real-time audit analysis.
	 - Part of an intrusion detection function.

### Audit Review

 - Audit review capability provides administrator with information from selected audit records:
	 - Actions of one or more users.
	 - Actions on a specific object or resource.
	 - All or a specified set of audited exceptions.
	 - Actions on a specific system / security attribute.
 - May be filtered by time / source / frequency.
 - Used to provide system activity baseline.
 - Level of security related activity.

### Approaches to Data Analysis

![[Pasted image 20260101232626.png]]